function errMsg(t){var e='\t\t<div id="profile_err_msg" class="ui negative message">\t\t<i class="close icon"></i>\t\t<div class="header">\t\tError uploading picture\t\t</div>\t\t<p>'+t+"</p>\t\t</div>";return e}function unDim(){$("#temp_loader").remove(),$(".special.cards .image").dimmer("toggle"),$("#pp_actions").toggle(),$(".special.cards .image").dimmer({closable:!0,on:"hover"})}$("#extrainfo-collapse").click(function(){$("#user-extrainfo-list").toggle("fast",function(){$("#btn-extrainfo-angle-up").toggleClass("up").toggleClass("down")})}),$("#links-collapse").click(function(){$("#user-links-list").toggle("fast",function(){$("#btn-angle-up").toggleClass("up").toggleClass("down")})}),$(".user-profile .tabular.menu .item").tab({alwaysRefresh:!0,ignoreFirstLoad:!1,cache:!1,apiSettings:{url:"../tabs/feed.php"}}),$("#user-joined-date").text("Joined "+moment($("#user-joined-date").text()).fromNow()),$("#post-date-ago").text(moment($("#post-date-ago").text()).fromNow()),$(".ui.dropdown").dropdown(),$(function(){var t='\t\t\t\t\t<div class="output">\t\t\t\t\t\t<div id="input-saved" class="ui green label">\t\t\t\t\t\t\t<i class="check icon"></i>Saved\t\t\t\t\t\t</div>\t\t\t\t\t</div>';$(".settings-content .user-settings-privacy select").on("change",function(e){var i=this.value,o=this.name,n=$(this),s=!1;$output=n.parents(".field").next().attr("class"),$.ajax({url:"/sha/controllers/_account.php",type:"post",dataType:"json",data:{action:"privacy_update",fields:o,values:i},success:function(e,i){if(console.log(e),"1"==e)"output"!=$output&&n.parents(".field").after(t),setTimeout(function(){n.parents(".field").next(".output").fadeOut(function(){this.remove()})},1300);else{var o='\t\t\t\t\t\t\t\t<div class="output">\t\t\t\t\t\t\t\t\t<div id="input-saved" class="ui red label">\t\t\t\t\t\t\t\t\t\t<i class="remove icon"></i>Error!\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>';s||(n.parents(".field").after(o),s=!0),setTimeout(function(){n.parents(".field").next(".output").fadeOut(function(){this.remove()})},4300)}},error:function(t,e,i){console.log(t),console.log("Details: "+e+"\nError:"+i)}})})}),$(".settings-content .user-settings-information, .user-settings-links, .user-settings form ").submit(function(t){t.preventDefault(),event.stopImmediatePropagation();for(var e,i=[],o=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=0;n<o.length;n++)e=o[n].split("="),i.push(e[0]),i[e[0]]=e[1];action="us"==i.st?"update_settings":"update_info";var s=$(".ui.form").form("is valid"),a=$(".ui.form").form("get values"),r=$(this),c=r,l=$("form .field :input"),d={};l.each(function(t,e){if("gender"==e.name){var i=$("option[selected]").val();return void(d[e.name]=i)}d[this.name]=$(this)[0].defaultValue});var u={};return $.each(a,function(t,e){e!=d[t]&&(u[t]=e)}),console.log(u),$.isEmptyObject(u)?(console.log("No fields changed."),null):(s&&(c.find(".output").remove(),c.addClass("loading"),$.ajax({url:"/sha/controllers/_account.php",type:"post",dataType:"json",data:{action:action,values:u},success:function(t,e){function i(t){return $err='<div class="output">\t\t\t\t\t\t\t<div id="input-saved" class="ui pointing red label">\t\t\t\t\t\t\t\t'+t+"</div>\t\t\t\t\t\t\t</div>",$err}if("1"==t){c.removeClass("loading");var o='\t\t\t\t\t\t\t<div class="output error">\t\t\t\t\t\t\t\t<div id="input-saved" class="ui green label">\t\t\t\t\t\t\t\t\t<i class="check icon"></i>Saved\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>';return $.each(u,function(t,e){"old_password"!=t&&(c.find("."+t+" :input").css({"background-color":"#dcffdc"}),c.parents(".ui.segment").css({"border-color":"#30ad00"}),$vis=c.find("."+t).next().hasClass("output"),$vis||c.find("."+t).after(o))}),console.log(u),setTimeout(function(){$.each(u,function(t,e){c.find(".field").next(".output").fadeOut(function(){this.remove()})})},2e3),!0}return c.removeClass("loading"),$.each(t,function(t,e){console.log(t),c.find("."+t+" :input").css({"background-color":"#f3bbbb"}),$vis=c.find("."+t).next().hasClass("output"),$vis||c.find("."+t).after(i(e))}),setTimeout(function(){$.each(u,function(t,e){c.find(".field").next(".output").fadeOut(function(){this.remove()})})},3500),!1},error:function(t,e,i){c.removeClass("loading"),console.log(i),console.log(e)}})),null)}),$(function(){$("#acc_del").click(function(){$(".ui.delete.segment").load("/sha/controllers/inc/account-delete.php")})}),$(".special.cards .image").dimmer({on:"hover",opacity:.3}),$(document).on("click","#changePicture, #uploadPicture",function(){$("#profile_err_msg").remove(),$("#myFile").click()}),$("#myFile").on("change",function(t){var e;e=t.target.files[0];var i=new FormData;i.append("file",e),$(".special.cards .image").dimmer("add content",'<div id="temp_loader" class="ui loader"></div>'),$(".special.cards .image").dimmer({closable:!1}),$("#pp_actions").toggle(),$.ajax({url:"../settings/api/profilePic.php",type:"post",data:i,dataType:"json",processData:!1,contentType:!1,cache:!1,success:function(t,e){if(console.log(t),"success"==t.status){unDim();var i='\t\t\t\t\t\t<div id="viewPicture" class="ui icon button" data-variation="mini" data-content="View Picture" >\t\t\t\t\t\t<i data-variation="mini" class="unhide icon link"></i>\t\t\t\t\t\t</div>',o='\t\t\t\t\t\t<div id="changePicture" class="ui small icon button" data-content="Change Picture" data-variation="mini">\t\t\t\t\t\t<i class="edit icon link"></i>\t\t\t\t\t\t</div>',n='\t\t\t\t\t\t<div id="deletePicture" class="ui small icon button" data-content="Delete Picture" data-variation="mini">\t\t\t\t\t\t<i class="trash outline icon link"></i>';$("#proflePicture").attr("src",t.path),$(".profile-picture-actions").children().remove(),$(".profile-picture-actions").append(i,o,n),$("#viewPicture").attr("href",t.path)}else unDim(),$("#profile_err_msg").remove(),$(".profile-body").prepend(errMsg(t.errMsg))},error:function(t,e,i){unDim(),$("#profile_err_msg").remove(),$(".profile-body").prepend(errMsg(e)),console.log("ERRORS: "+e)}})}),$(document).on("click","#deletePicture",function(t){$(".special.cards .image").dimmer("add content",'<div id="temp_loader" class="ui loader"></div>'),$(".special.cards .image").dimmer({closable:!1}),$("#pp_actions").toggle(),$.ajax({url:"../settings/api/profilePic.php",type:"post",data:{action:"delete"},dataType:"json",success:function(t,e){if("success"==t.status){unDim();var i='\t\t\t\t\t\t<div id="uploadPicture" class="ui small icon button" data-content="Upload Picture" data-variation="mini">\t\t\t\t\t\t<i class="cloud upload icon link"></i>\t\t\t\t\t\t</div>';"success"==t.status&&($("#proflePicture").attr("src",t.path),$(".profile-picture-actions").children().remove(),$(".profile-picture-actions").append(i))}else unDim(),$("#profile_err_msg").remove(),$(".profile-body").prepend(errMsg(t.errMsg))},error:function(t,e,i){unDim(),$("#profile_err_msg").remove(),$(".profile-body").prepend(errMsg(e)),console.log("ERRORS: "+e)}})}),$(document).on("click",".message .close",function(){$(this).closest(".message").transition("fade")}),$(document).on("click","#viewPicture",function(t){t.preventDefault(),$(".page.dimmer:first").dimmer("toggle")}),$("#dimmer-close").click(function(){console.log("??"),$(".page.dimmer:first").dimmer("hide")}),$(".ui.icon.button").popup({position:"top right"}),$(".page.dimmer:first").dimmer({onShow:function(){$.ajax({url:"../settings/api/profilePic.php",type:"get",data:{action:"get_pic_info",id:userID},dataType:"json",success:function(t,e){"object"==typeof t&&($("#pic_details_name").html("Name: "+t.name+"."+t.extension),$("#pic_details_size").html("Size: "+t.size),$("#pic_details_dim").html("Dimensions: "+t.width+" x "+t.height),$("#pic_details_link").attr("href",t.path),$("#pic_details_link").attr("download",t.name+"."+t.extension),$("#pic_details_pp").attr("src",t.path))},error:function(t,e,i){unDim(),$("#profile_err_msg").remove(),$(".profile-body").prepend(errMsg(e)),console.log("ERRORS: "+e)}})}});