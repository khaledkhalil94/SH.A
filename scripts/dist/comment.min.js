function output_comment(t){function e(t){var e=' \t\t\t<div class="ui minimal comments">\t\t\t\t<div class="ui comment padded segment" comment-id="'+t.id+'">\t\t\t\t\t<a class="avatar" href="/user/'+t.uid+'/">\t\t\t\t\t\t<img src="'+t.img_path+'">\t\t\t\t\t</a>\t\t\t\t\t<div class="content">\t\t\t\t\t\t<a class="author" href="/user/'+t.uid+'/">'+t.name+'</a>\t\t\t\t\t\t<div class="metadata">\t\t\t\t\t\t\t<span class="date">'+moment(t.created).fromNow()+'</span>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="text">\t\t\t\t\t\t\t<h4>'+t.content+'</h4>\t\t\t\t\t\t</div>\t\t\t\t\t\t<a class="comment-vote-btn"><i class="heart circular icon"></i></a><span class="comment-votes-count"></span>\t\t\t\t\t\t<div title="Actions" class="ui pointing dropdown" id=\'comment-actions\'>\t\t\t\t\t\t\t<i class="ellipsis link big horizontal icon"></i>\t\t\t\t\t\t\t<div class="menu">\t\t\t\t\t\t\t\t<div class="item" id="edit">\t\t\t\t\t\t\t\t\t<a class="edit">Edit</a>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div class="item" id="del">\t\t\t\t\t\t\t\t\t<a class="delete">Delete</a>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t</div>';return e}$.ajax({url:"/controllers/_comment.php",type:"get",dataType:"json",data:{action:"get_comment",id:t},success:function(t,o){$comment=e(t),$("#comments").prepend($comment),$(".ui.dropdown").dropdown();var n=parseInt($("#commentscount").text())+1;$("#commentscount").text(n),$("#subcomment").addClass("disabled"),$(".commentz form").removeClass("loading"),$("#emptycmt").remove(),$(".reply textarea").val(""),$("#subcomment").hide()},error:function(t,e,o){$("#subcomment").addClass("disabled"),$(".commentz form").removeClass("loading"),console.log(t),console.log("Details: "+e+"\nError:"+o)}})}$(function(){$("#comments").on("click",".comment-vote-btn",function(t){t.preventDefault(),t.stopPropagation();var e=$(this),o=e.closest(".comment"),n=o.attr("comment-id");e.hasClass("voted")?$.ajax({url:"/controllers/_comment.php",type:"post",dataType:"json",data:{action:"downvote",comment_id:n},success:function(t,e){if(1==t.status){o.find($(".comment-vote-btn")).removeClass("voted"),o.find($(".comment-vote-btn i")).removeClass("red");var n=parseInt(o.find($(".comment-votes-count")).text());n=1==n?"":n-1,o.find($(".comment-votes-count")).text(n)}},error:function(t,e,o){console.log(t),console.log("Details: "+e+"\nError:"+o)}}):$.ajax({url:"/controllers/_comment.php",type:"post",dataType:"json",data:{action:"upvote",comment_id:n},success:function(t,e){if(1==t.status){o.find($(".comment-vote-btn")).addClass("voted"),o.find($(".comment-vote-btn i")).addClass("red");var n=parseInt(o.find($(".comment-votes-count")).text());n=isNaN(n)?1:n+1,o.find($(".comment-votes-count")).text(n)}},error:function(t,e,o){console.log(t),console.log("Details: "+e+"\nError:"+o)}})})}),$(function(){$("#comment-submit-textarea").focusin(function(){$("#subcomment").show()}),$("#comment-submit-textarea").keyup(function(){var t=$(this),e=t.val(),o=t.val().length;o>0&&""!=e.trim()&&$("#subcomment").removeClass("disabled"),(o<1||""==e.trim())&&$("#subcomment").addClass("disabled")}),$("#subcomment").on("click",function(t){t.preventDefault();var e=$("textarea").val();token=$("input[name='comment_token']").val(),$id=$(".blog-post").attr("id")||$("#post-page").attr("post-id"),$(".commentz form").addClass("loading"),$.ajax({url:"/controllers/_comment.php",type:"post",dataType:"json",data:{action:"new_comment",content:e,post_id:$id,token:token},success:function(t,e){return 1==t.status?(id=t.id,void output_comment(id)):($(".commentz form").removeClass("loading"),console.log(t),$("#subcomment").addClass("disabled"),void $(".commentz form").removeClass("loading"))},error:function(t,e,o){$(".commentz form").removeClass("loading"),console.log(t),console.log("Details: "+e+"\nError:"+o)}})})}),$(function(){var t,e,o,n,a,s,c;$(document).on("click","#post_report",function(s){c=$(this);var i=!!c.parents(".blog-post").length;i?($type="post",t=c.closest(".blog-post"),e=t.attr("id")):($type="comment",t=c.closest(".comment"),e=t.attr("comment-id")),$(".ui.modal.report").modal("setting",{onHidden:function(){$("#report-cancel").click(),"undefined"==typeof n||appd||($(".modal.report .message").replaceWith(n),$(".modal.report .actions").append(a),appd=!0)}}).modal("show"),i?$(".ui.message").remove():(o=t.find($("h4")).text(),$(".description p").text(o))}),$(".checkbox").checkbox({onChange:function(){$("#modalForm").toggle(400)}}),$(document).on("click","#report-confirm",function(t){var o=$("#modalForm textarea").val();appd=!1,$loader='<div class="ui container segment" style="margin:40px 0px;">\t\t\t\t<div class="ui loading form" id="modalForm">\t\t\t\t<div class="field">\t\t\t\t<textarea rows="6"></textarea>\t\t\t\t</div>\t\t\t\t</div>\t\t\t\t</div>',$(".checkbox").checkbox("uncheck"),$("#modalForm textarea").val(""),n=$(".modal.report .content").replaceWith($loader),$.ajax({url:"/controllers/_comment.php",type:"post",dataType:"json",data:{action:"report",type:$type,content:o,post_id:e},success:function(t,e){console.log(t),1==t.status?($sucMsg='\t\t\t\t\t\t\t\t<div class="ui success message" style="width: 95%; margin: 25px auto;">\t\t\t\t\t\t\t\t<div class="header">\t\t\t\t\t\t\t\tSuccess!\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<ul class="list">\t\t\t\t\t\t\t\t<li>Comment has been reported, thanks for you submission.</li>\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>',$(".modal.report .container").replaceWith($sucMsg),a=$("#report-confirm"),a.remove()):1062==t.err?(s='\t\t\t\t\t\t\t<div class="ui error message" style="width: 95%; margin: 25px auto;">\t\t\t\t\t\t\t<div class="header">\t\t\t\t\t\t\tError!\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<ul class="list">\t\t\t\t\t\t\t<li>You have already reported this comment.</li>\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>',$cancelBtn='\t\t\t\t\t\t\t<div class="actions" style="text-align:right;">\t\t\t\t\t\t\t<div class="ui white deny button" id="report-cancel">Close\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>',$(".modal.report .container").replaceWith(s),a=$("#report-confirm"),a.remove()):(s='\t\t\t\t\t\t\t<div class="ui error message" style="width: 95%; margin: 25px auto;">\t\t\t\t\t\t\t<div class="header">\t\t\t\t\t\t\tError!\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<ul class="list">\t\t\t\t\t\t\t<li>'+t.err+".</li>\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>",$(".modal.report .container").replaceWith(s),a=$("#report-confirm"),a.remove())},error:function(t,e,o){console.log(t),console.log("Details: "+e+"\nError:"+o)}})}),$(".modal.report").on("click","#report-cancel",function(t){t.stopPropagation(),console.log("cancelling"),$newContent="",$("#modalForm textarea").val(""),$(".checkbox").checkbox("uncheck"),$("#modalForm").hide()})}),$(function(){var t;$(document).on("click","#del",function(e){e.preventDefault(),t=$(this);var o=t.closest(".comment").find($("h4")).text();$(".description p").text(o),$(".ui.modal.comment.delete").modal("show")}),$("#comment-confirmDel").click(function(e){e.stopPropagation(),e.preventDefault();var o=t.parents(".comment"),n=t.parents(".comment").attr("comment-id"),a='<span id="emptycmt">There is nothing here yet, be the first to comment!</span>';$.ajax({url:"/controllers/_comment.php",dataType:"json",type:"post",data:{action:"delete",id:n},success:function(t,e){if(1==t.status){var n=parseInt($("#commentscount").text())-1;$("#commentscount").text(n),o.parent().remove(),0===n&&$("#comments").append(a),$(".ui.small.modal").modal("hide")}},error:function(t,e,o){console.log(t),console.log("Details: "+e+"\nError:"+o)}})})}),$(function(){var t,e,o,n,a,s="",c=!1;$(document).on("click","#edit",function(s){s.stopPropagation(),s.preventDefault(),c&&$("#cancel").click(),c=!0,_this=$(this),e=_this.closest(".comment"),$element=e.find(".text h4"),t=$element.text(),n=e.find("#comment-actions"),a=e.find(".comment-points");var i='\t\t\t\t\t<div class="ui vertical segment content-form form">\t\t\t\t\t<div class="field" style="clear: none;">\t\t\t\t\t<textarea id="content" rows="2">'+t+'</textarea><br />\t\t\t\t\t</div>\t\t\t\t\t<button class="ui mini green button" id="save">Save</button>\t\t\t\t\t<button class="ui mini button" id="cancel">Cancel</button>\t\t\t\t\t</div>';o=$element.replaceWith(i),_form=_this.closest(".comment").find(".form"),n.hide(),a.hide()}),$("#comments").on("click","#save",function(o){o.stopPropagation();var n=e.attr("comment-id");if(s=e.find("textarea#content").val(),"undefined"!=typeof s){if(""==s.trim())return void e.find("#del").click();if(t==s)return void $("#cancel").click();_form.addClass("loading"),$.ajax({url:"/controllers/_comment.php",type:"post",dataType:"json",data:{action:"edit",content:s,id:n},success:function(t,o){if(1==t.status){var n='(edited <span id="editedDate">A few seconds ago</span>)';e.find("#editedDate").length>0?$postDOM.find("#editedDate").text("A few seconds ago"):e.find(".metadata").append(n),_form.replaceWith("<h4>"+s+"</h4>"),e.find("#comment-actions, .comment-points").show()}c=!1},error:function(t,e,o){$("#cancel").click(),c=!1}})}}),$("#comments").on("click","#cancel",function(t){return t.stopPropagation(),_form.replaceWith(o),n.show(),a.show(),c=!1,null})}),$(function(){$(document).on("click","#comment_hide",function(){$(this).parents(".minimal.comments").fadeOut(200)})});